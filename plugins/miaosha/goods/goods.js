(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/miaosha/goods/goods"],{"119e":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=(t._self._c,Number(110));t.$mp.data=Object.assign({},{$root:{m0:n}})},o=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},1596:function(t,e,n){"use strict";n.r(e);var i=n("119e"),o=n("329b");for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);n("97ee");var r=n("2877"),s=Object(r["a"])(o["default"],i["a"],i["b"],!1,null,"395cb0c9",null);e["default"]=s.exports},"329b":function(t,e,n){"use strict";n.r(e);var i=n("a025"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=o.a},"97ee":function(t,e,n){"use strict";var i=n("d38f"),o=n.n(i);o.a},a025:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("a34a")),o=n("2f62");function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,i,o,a,r){try{var s=t[a](r),p=s.value}catch(c){return void n(c)}s.done?e(p):Promise.resolve(p).then(i,o)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var a=t.apply(e,n);function s(t){r(a,i,o,s,p,"next",t)}function p(t){r(a,i,o,s,p,"throw",t)}s(void 0)})}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach(function(e){u(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){return n.e("components/page-component/goods/app-goods-banner").then(n.bind(null,"12b6"))},l=function(){return n.e("plugins/miaosha/components/app-goods-time").then(n.bind(null,"89a5"))},h=function(){return n.e("plugins/miaosha/components/app-merchant-guarantee").then(n.bind(null,"067f"))},m=function(){return n.e("plugins/miaosha/components/app-price-title-share").then(n.bind(null,"8c55"))},f=function(){return n.e("components/page-component/app-attr/app-attr").then(n.bind(null,"d3c4"))},g=function(){return n.e("components/page-component/goods/app-goods-attr").then(n.bind(null,"9dc1"))},_=function(){return n.e("components/page-component/app-related-suggestion-product/app-related-suggestion-product").then(n.bind(null,"1ce4"))},b=function(){return n.e("components/page-component/goods/app-goods-service").then(n.bind(null,"311c"))},v=function(){return n.e("components/page-component/goods/app-goods-marketing").then(n.bind(null,"1143"))},y=function(){return n.e("components/page-component/app-join-member/app-join-member").then(n.bind(null,"40f4"))},w=function(){return n.e("components/page-component/goods/app-goods-detail").then(n.bind(null,"5abf"))},O=function(){return n.e("components/page-component/app-iphonex-bottom/app-iphonex-bottom").then(n.bind(null,"bc3b"))},$=function(){return n.e("components/basic-component/app-iphone-x/app-iphone-x").then(n.bind(null,"7598"))},j=function(){return n.e("components/basic-component/app-empty-bottom/app-empty-bottom").then(n.bind(null,"0c06"))},A=function(){return n.e("components/page-component/app-vip-card/app-vip-card").then(n.bind(null,"19f0"))},I={name:"goods",data:function(){return{detail:{},cartShow:!1,miaosha_status:-1,miaosha_time:0,selectAttr:null,previewUrl:this.$api.miaosha.order_preview,submitUrl:this.$api.miaosha.order_submit,url:"",show:!1,list:[],miaosha_buy_count:0,appAttr:{},goods_id:-1,is_activity:0,hour:0,minute:0,second:0,day:0,time:-1,is_vip_card_user:0,discount:null,is_vip:!1,loading:!1,poster_config:this.$api.miaosha.poster_config,poster_generate:this.$api.miaosha.poster_generate}},onLoad:function(t){this.goods_id=t.id,t.is_activity&&(this.is_activity=t.is_activity)},onShow:function(){var e=this;this.$showLoading(),this.$nextTick(function(){var n=e;e.$request({url:e.$api.miaosha.goods_detail,data:{id:e.goods_id,is_activity:e.is_activity}}).then(function(i){if(e.$hideLoading(),0===i.code){var o=i.data,a=o.detail,r=o.miaosha_status,s=o.miaosha_time,p=o.miaosha_buy_count;e.detail=a,e.miaosha_status=r,e.miaosha_buy_count=p,e.loading=!0,e.url="".concat(e.$api.miaosha.poster,"&goods_id=").concat(e.detail.id),e.poster_config="".concat(e.poster_config,"&goods_id=").concat(e.detail.id),e.poster_generate="".concat(e.poster_generate,"&goods_id=").concat(e.detail.id),e.getTime(s)}else t.showToast({title:i.msg,icon:"none"});e.$request({url:e.$api.goods.new_recommend,data:{goods_id:e.detail.id}}).then(function(t){0===t.code&&(e.list=t.data.list,n.detail.vip_card_appoint.discount>0&&(n.is_vip=!0,n.discount=n.detail.vip_card_appoint.discount),n.is_vip_card_user=n.detail.vip_card_appoint.is_vip_card_user)})})})},onHide:function(){clearInterval(this.time)},onUnload:function(){clearInterval(this.time)},computed:c({},(0,o.mapState)("gConfig",{iphone:function(t){return t.iphone},iphoneHeight:function(t){return t.iphoneHeight}}),{},(0,o.mapGetters)("mallConfig",{getTheme:"getTheme"}),{},(0,o.mapState)({mall:function(t){return t.mallConfig.mall}})),onShareAppMessage:function(){return this.$shareAppMessage({path:"/plugins/miaosha/goods/goods",title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,imageUrl:this.detail.app_share_pic?this.detail.app_share_pic:"",params:{id:this.detail.id}})},methods:{attr:function(t){this.appAttr=t},request:function(){var t=s(i.default.mark(function t(e){var n,o,a;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.url,o=e.data,t.next=3,this.$request({url:n,data:o});case 3:if(a=t.sent,0!==a.code){t.next=6;break}return t.abrupt("return",a.data);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),attrtap:function(t){this.selectAttr=null!==t?t:null},joinCart:function(){var t=this;"none"===this.appAttr.display?this.show=Math.random():this.$request({url:this.$api.miaosha.add_cart,method:"post",data:{miaosha_goods_id:this.selectAttr.goods_id,attr_id:this.selectAttr.id,num:this.appAttr.number}}).then(function(e){0===e.code&&(t.appAttr.display="none")})},buy:function(){if("none"===this.appAttr.display)this.show=Math.random();else{for(var t=this.detail.mch_id,e=[],n={id:this.detail.id,attr:[],num:this.appAttr.number,goods_attr_id:this.selectAttr.id,cart_id:0},i=0;i<this.selectAttr.attr_list.length;i++){var o={attr_id:this.selectAttr.attr_list[i].attr_id,attr_group_id:this.selectAttr.attr_list[i].attr_group_id};n.attr.push(o)}e.push({mch_id:t,goods_list:[n]}),this.$jump({open_type:"navigate",url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify(e),"&preview_url=").concat(encodeURIComponent(this.previewUrl),"&submit_url=").concat(encodeURIComponent(this.submitUrl))})}},getTime:function(t){var e=this;t-=1,this.day=parseInt(t/3600/24),this.hour=parseInt(t/3600%24),this.minute=parseInt(t/60%60),this.second=parseInt(t%60),clearInterval(this.time),this.time=setInterval(function(){t-=1,t<0&&clearInterval(e.time),e.day=parseInt(t/3600/24),e.hour=parseInt(t/3600%24),e.minute=parseInt(t/60%60),e.second=parseInt(t%60)},1e3)}},components:{"app-banner":d,"app-goods-time":l,"app-merchant-guarantee":h,"app-price-title-share":m,"app-attr":f,"app-goods-attr":g,"app-related-suggestion-product":_,"app-goods-service":b,"app-goods-marketing":v,"app-join-member":y,"app-goods-detail":w,"app-iphone-bottom":O,"app-iphone-x":$,"app-empty-bottom":j,"app-vip-card":A}};e.default=I}).call(this,n("543d")["default"])},d38f:function(t,e,n){}},[["5baa","common/runtime","common/vendor"]]]);