(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"64f0":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},"650b":function(t,e,i){"use strict";i.r(e);var n=i("64f0"),r=i("e143");for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);i("d762");var s=i("2877"),c=Object(s["a"])(r["default"],n["a"],n["b"],!1,null,"9c178f72",null);e["default"]=c.exports},cac6:function(t,e,i){},d762:function(t,e,i){"use strict";var n=i("cac6"),r=i.n(n);r.a},e143:function(t,e,i){"use strict";i.r(e);var n=i("face"),r=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=r.a},face:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("2f62");function r(t){return c(t)||s(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function c(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(i,!0).forEach(function(e){u(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d=function(){return Promise.all([i.e("common/vendor"),i.e("components/page-component/app-goods-list/app-goods-list")]).then(i.bind(null,"3f73"))},f=1,l=!1,m=!1,g={name:"search",components:{"app-goods-list":d},data:function(){return{searchList:[],searchKey:"",list:[],isSearch:!1,historyList:[],keyword:"",recommend_list:[],mch_id:0}},computed:h({},(0,n.mapState)({theme:function(t){return t.mallConfig.theme}}),{},(0,n.mapGetters)("mallConfig",{getTheme:"getTheme"}),{newList:function(){return this.list.length>0?this.list:this.recommend_list}}),onLoad:function(t){this.mch_id=t.mch_id?t.mch_id:0,f=1,l=!1,m=!1,this.historyList=this.getHistory(),this.mch_id||this.getSearchList(),this.getRecommend()},onReachBottom:function(){m||this.getGoodsList()},watch:{keyword:{handler:function(t){""==t&&this.cancel()},immediate:!0}},methods:{clear:function(){t.hideKeyboard(),this.keyword=""},getSearchList:function(){var t=this;this.$showLoading(),this.$request({url:this.$api.default.search_list}).then(function(e){t.$hideLoading(),t.searchList=e.data})},switchSearch:function(t){this.searchKey=t,this.historyList=this.getHistory(),this.reset()},cancel:function(){this.isSearch=!1,this.keyword="",this.list=[]},reset:function(){f=1,m=!1,this.getGoodsList()},search:function(t){var e=this.keyword;""!==e&&(this.keyword=e.trim(),this.setHistory(),this.reset())},getGoodsList:function(){var e=this;this.keyword&&(l||(l=!0,t.showLoading(),this.$request({url:this.$api.default.goods_list,data:{keyword:this.keyword,sign:this.searchKey,mch_id:this.mch_id,page:f}}).then(function(i){var n;(t.hideLoading(),l=!1,e.isSearch=!0,0===i.code)?(1==f&&(e.list=[]),i.data.list.length>0?((n=e.list).push.apply(n,r(i.data.list)),f++):(m=!0,1===f&&e.getRecommend())):t.showModal({content:i.msg})}).catch(function(){l=!1,t.hideLoading()})))},setHistory:function(){var e=this.getHistory(),i=this.keyword.trim();e.forEach(function(t,n){t.keyword===i&&e.splice(n,1)}),e.push({keyword:i}),e.length>20&&e.shift(),this.historyList=e,t.setStorageSync("SEARCH_HISTORY_LIST",e)},getHistory:function(){var e=t.getStorageSync("SEARCH_HISTORY_LIST");return e||(e=[]),e},deleteHistory:function(){t.removeStorageSync("SEARCH_HISTORY_LIST"),this.historyList=[]},historyClick:function(t){this.keyword=t.trim(),this.reset()},getRecommend:function(){var t=this;this.mch_id||this.recommend_list.length>0||this.$request({url:this.$api.goods.new_recommend,data:{goods_id:0,type:"goods"}}).then(function(e){0===e.code&&(t.recommend_list=e.data.list)})}}};e.default=g}).call(this,i("543d")["default"])}},[["eef2","common/runtime","common/vendor"]]]);